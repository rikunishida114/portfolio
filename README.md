# Two-Link Arm Reacher（2リンク・リーチング）

## 概要

Two-Link Arm Reacher は、2 関節ロボットアームのリーチング動作を  
物理シミュレーションと強化学習（RL）で学習・可視化するプロジェクトです。

Python でカスタム実装した 2 リンクアーム環境上で目標位置への到達動作を学習させ、
「ゴールできるか」だけでなく、人の到達運動に近い軌道を再現できているかを検証できるようにしています。

人の到達運動では一般に、

- 手先の軌道は目標に向かってほぼ直線的
- 速度プロファイルは運動時間の中盤に 1 つだけピークを持つベル型

といった特徴が知られています。

本プロジェクトでは、距離・時間・手先躍度（jerk）などを報酬として組み合わせることで、
報酬設計の違いによって軌道パターンがどのように変化するかを比較・可視化できるように構成しています。
学習ログの保存とプロット用スクリプトも含めており、  
学習アルゴリズムには Stable-Baselines3を用いつつ、

- 2 リンクアームの物理シミュレーション環境
- 報酬設計・エピソード管理
- 学習スクリプト、ログ保存・可視化

を自前で実装した、「物理シミュレーション + RL + ログ／可視化」を一連のワークフローとしてまとめた実験用リポジトリです。


---

## 出力例

### 手先軌道＋アーム姿勢

![Trajectory + Arms](two_rink_reacher/logs/end_result_2joint_with_handnorms_trajectory_with_arms.png)

学習済みポリシーで得られた手先軌道と、各時刻のアーム姿勢を重ねて表示した図です。  
目標位置への到達パターンと関節の動き方を一枚で確認できます。

---

### 手先ノルム（速度・加速度・躍度）

![Hand Norms](two_rink_reacher/logs/end_result_2joint_with_handnorms_hand_norms.png)

手先の速度・加速度・躍度（jerk）の時間変化をプロットした図です。  
リーチング中のピーク速度の位置や滑らかさを定量的に見ることができます。

---

### 関節ダイナミクス（角度・角速度・角加速度）

![Joint Dynamics](two_rink_reacher/logs/end_result_2joint_with_handnorms_joint_dynamics.png)

各関節の角度・角速度・角加速度・角躍度の時間推移をまとめた図です。  
手先レベルだけでなく、関節空間でどのように動いているかを確認できます。

---

### 報酬成分の推移

![Reward Components](two_rink_reacher/logs/group_reward_components.png)

距離・時間・躍度ペナルティなど、報酬成分ごとにまとめた図です。  
学習が進むにつれて、どの項目がどのように変化しているかを把握できます。

---

## 機能・ポイント

- カスタム物理環境  
  2リンクアームのダイナミクス（質量行列、コリオリ項、重力項、減衰）を自前で実装し、  
  Gym 互換の環境として RL アルゴリズムから利用できるようにしています。

- 連続制御タスクの学習  
  関節トルクをアクションとする連続制御タスクを、SAC や PPO などのアルゴリズムで学習できます。

- 報酬設計とログ  
  距離・時間・手先躍度などを分解した報酬を記録し、  
  どの報酬設計がどのような挙動につながったかを後から分析しやすい構成にしています。

- 可視化用ノートブック  
  学習済みポリシーの軌道、速度プロファイル、報酬推移などを  
  まとめて描画する Jupyter Notebook を用意しています。

---

## 技術キーワード

- Python / NumPy / Matplotlib  
- 自作 Gym 環境（2リンクアームの物理シミュレーション）  
- 強化学習（SAC / PPO, stable-baselines3）  
- Jupyter Notebook によるログ解析・可視化  

---

## プロジェクト構成（抜粋）

```bash
portfolio/
├── one_rink_reacher/              # C言語版（1関節・基底関数による RL 実験）
│   ├── main.c
│   ├── function.c
│   └── param.h
├── two_rink_reacher/              # Python / RL 実装（メイン）
│   ├── jerk_min.ipynb             # 学習・評価・可視化ノートブック
│   ├── logs/                      # 学習結果（CSV / PNG など）
│   └── models/                    # 学習済みモデル（任意）
└── ...
